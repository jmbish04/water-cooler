# Autogenerated TOML mirror so tools expecting wrangler.toml can run.
# Source of truth remains wrangler.jsonc; keep the two in sync.

name = "water-cooler"
main = "src/index.ts"
compatibility_date = "2025-03-07"
compatibility_flags = ["nodejs_compat"]
logpush = false

[observability]
enabled = true
head_sampling_rate = 1

[vars]
AI_MODEL = "@cf/openai/gpt-4o-mini"
ENVIRONMENT = "production"

[assets]
directory = "./public"
binding = "ASSETS"

[[d1_databases]]
binding = "DB"
database_name = "water-cooler"
database_id = "72a62149-b39a-4390-912a-6aef100f3a76"
migrations_dir = "migrations"

[[kv_namespaces]]
binding = "CACHE"
id = "f4669a0eecf0460b8e86beca65853a07"

[[r2_buckets]]
binding = "R2"
bucket_name = "water-cooler-assets"

[queues]
  [[queues.producers]]
  binding = "SCAN_QUEUE"
  queue = "water-cooler-scan"

  [[queues.consumers]]
  queue = "water-cooler-scan"
  max_batch_size = 10
  max_batch_timeout = 30

[ai]
binding = "AI"

[[vectorize]]
binding = "VEC"
index_name = "curation_vectors_v2"

[durable_objects]
  [[durable_objects.bindings]]
  name = "SCHEDULER_ACTOR"
  class_name = "SchedulerActor"

  [[durable_objects.bindings]]
  name = "GITHUB_ACTOR"
  class_name = "GitHubActor"

  [[durable_objects.bindings]]
  name = "APPSTORE_ACTOR"
  class_name = "AppStoreActor"

  [[durable_objects.bindings]]
  name = "REDDIT_ACTOR"
  class_name = "RedditActor"

  [[durable_objects.bindings]]
  name = "DISCORD_ACTOR"
  class_name = "DiscordActor"

  [[durable_objects.bindings]]
  name = "IGDUX_ACTOR"
  class_name = "IgduxActor"

  [[durable_objects.bindings]]
  name = "CURATOR_ACTOR"
  class_name = "CuratorActor"

  [[durable_objects.bindings]]
  name = "USER_SESSION_ACTOR"
  class_name = "UserSessionActor"

  [[durable_objects.bindings]]
  name = "ROOM_DO"
  class_name = "RoomDO"

[[migrations]]
tag = "v1"
new_classes = [
  "SchedulerActor",
  "GitHubActor",
  "AppStoreActor",
  "RedditActor",
  "DiscordActor",
  "CuratorActor",
  "UserSessionActor",
]

[[migrations]]
tag = "v2"
new_classes = ["IgduxActor"]

[[migrations]]
tag = "v3"
new_classes = ["RoomDO"]

[[send_email]]
name = "MAILER"

[triggers]
crons = ["0 0 * * *"]

[placement]
mode = "smart"
