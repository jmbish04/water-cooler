/**
 * Wrangler Configuration for AI-Curated Discovery Hub
 *
 * Cloudflare Workers configuration with:
 * - Durable Objects (Actors) for stateful operations
 * - D1 for relational data + audit logs
 * - KV for caching external API responses
 * - R2 for asset storage
 * - Queues for async scan processing
 * - Vectorize for semantic search
 * - AI binding for curation & Q&A
 * - Email for digest delivery
 * - Static assets served from /public
 *
 * AI Agent Hints:
 * - All bindings are strongly typed in src/types/env.ts
 * - AI_MODEL can be overridden via env vars (default: @cf/openai/gpt-oss-120b)
 * - Observability enabled for production monitoring
 */
{
  "name": "water-cooler",
  "main": "src/index.ts",
  "compatibility_date": "2025-11-01",

  "vars": {
    "AI_MODEL": "@cf/openai/gpt-oss-120b",
    "ENVIRONMENT": "production"
  },

  "assets": {
    "directory": "./public",
    "binding": "ASSETS"
  },

  "d1_databases": [
    {
      "binding": "DB",
      "database_name": "water-cooler",
      "database_id": "72a62149-b39a-4390-912a-6aef100f3a76",
      "migrations_dir": "migrations"
    }
  ],

  "kv_namespaces": [
    {
      "binding": "CACHE",
      "id": "f4669a0eecf0460b8e86beca65853a07"
    }
  ],

  "r2_buckets": [
    {
      "binding": "R2",
      "bucket_name": "water-cooler-assets"
    }
  ],

  "queues": {
    "producers": [
      {
        "binding": "SCAN_QUEUE",
        "queue": "water-cooler-scan"
      }
    ],
    "consumers": [
      {
        "queue": "water-cooler-scan",
        "max_batch_size": 10,
        "max_batch_timeout": 30
      }
    ]
  },

  "ai": {
    "binding": "AI"
  },

  "vectorize": [
    {
      "binding": "VEC",
      "index_name": "water-cooler"
    }
  ],

  "durable_objects": {
    "bindings": [
      {
        "name": "SCHEDULER_ACTOR",
        "class_name": "SchedulerActor",
        "script_name": "curation-hub"
      },
      {
        "name": "GITHUB_ACTOR",
        "class_name": "GitHubActor",
        "script_name": "curation-hub"
      },
      {
        "name": "APPSTORE_ACTOR",
        "class_name": "AppStoreActor",
        "script_name": "curation-hub"
      },
      {
        "name": "REDDIT_ACTOR",
        "class_name": "RedditActor",
        "script_name": "curation-hub"
      },
      {
        "name": "DISCORD_ACTOR",
        "class_name": "DiscordActor",
        "script_name": "curation-hub"
      },
      {
        "name": "CURATOR_ACTOR",
        "class_name": "CuratorActor",
        "script_name": "curation-hub"
      },
      {
        "name": "USER_SESSION_ACTOR",
        "class_name": "UserSessionActor",
        "script_name": "curation-hub"
      }
    ]
  },

  "send_email": [
    {
      "name": "MAILER"
    }
  ],

  "observability": {
    "enabled": true,
    "head_sampling_rate": 1
  },

  "logpush": false,

  "placement": {
    "mode": "smart"
  }
}
